

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ultranest.plot &mdash; UltraNest 3.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
  
  
  
    <link rel="canonical" href="https://johannesbuchner.github.io/UltraNest/_modules/ultranest/plot.html"/>
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> UltraNest
          

          
            
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">UltraNest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../method.html">Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using-ultranest.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../priors.html">Specifying priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Tour of the features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../example-sine-line.html">Time series fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-sine-modelcomparison.html">Model comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-sine-highd.html">Higher-dimensional fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-intrinsic-distribution.html">Tutorial: intrinsic distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-line.html">Tutorial: fitting a line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-outliers.html">Tutorial: distribution with outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example-sine-bayesian-workflow.html">Bayesian workflow</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">UltraNest</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>ultranest.plot</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ultranest.plot</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Plotting utilities.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">print_function</span><span class="p">,</span> <span class="n">division</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">range</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">NullLocator</span>
<span class="c1"># from matplotlib.colors import LinearSegmentedColormap, colorConverter</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span>

<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">resample_equal</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">quantile</span> <span class="k">as</span> <span class="n">_quantile</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">str_type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">StringTypes</span>
    <span class="n">float_type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">FloatType</span>
    <span class="n">int_type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">IntType</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="n">str_type</span> <span class="o">=</span> <span class="nb">str</span>
    <span class="n">float_type</span> <span class="o">=</span> <span class="nb">float</span>
    <span class="n">int_type</span> <span class="o">=</span> <span class="nb">int</span>

<span class="kn">import</span> <span class="nn">corner</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;runplot&quot;</span><span class="p">,</span> <span class="s2">&quot;cornerplot&quot;</span><span class="p">,</span> <span class="s2">&quot;traceplot&quot;</span><span class="p">,</span> <span class="s2">&quot;PredictionBand&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="cornerplot"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.cornerplot">[docs]</a><span class="k">def</span> <span class="nf">cornerplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a corner plot with corner.&quot;&quot;&quot;</span>
    <span class="n">paramnames</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;paramnames&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;weighted_samples&#39;</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">])</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;weighted_samples&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">])</span>
    <span class="n">cumsumweights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">cumsumweights</span> <span class="o">&gt;</span> <span class="mf">1e-4</span>

    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warn</span> <span class="o">=</span> <span class="s1">&#39;Posterior is still concentrated in a single point:&#39;</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paramnames</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;samples&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
                <span class="n">warn</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;    </span><span class="si">%-20s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warn</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Try running longer.&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># monkey patch to disable a useless warning</span>
    <span class="n">oldfunc</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">warning</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="kc">None</span>
    <span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">,:],</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
                  <span class="n">labels</span><span class="o">=</span><span class="n">paramnames</span><span class="p">,</span> <span class="n">show_titles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="n">oldfunc</span></div>


<div class="viewcode-block" id="PredictionBand"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand">[docs]</a><span class="k">class</span> <span class="nc">PredictionBand</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot bands of model predictions as calculated from a chain.</span>

<span class="sd">    call add(y) to add predictions from each chain point</span>

<span class="sd">    Example::</span>

<span class="sd">        x = numpy.linspace(0, 1, 100)</span>
<span class="sd">        band = PredictionBand(x)</span>
<span class="sd">        for c in chain:</span>
<span class="sd">            band.add(c[0] * x + c[1])</span>
<span class="sd">        # add median line</span>
<span class="sd">        band.line(color=&#39;k&#39;)</span>
<span class="sd">        # add 1 sigma quantile</span>
<span class="sd">        band.shade(color=&#39;k&#39;, alpha=0.3)</span>
<span class="sd">        # add wider quantile</span>
<span class="sd">        band.shade(q=0.01, color=&#39;gray&#39;, alpha=0.1)</span>
<span class="sd">        plt.show()</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: array</span>
<span class="sd">        The independent variable</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">shadeargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">lineargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Initialise with independent variable *x*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadeargs</span> <span class="o">=</span> <span class="n">shadeargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineargs</span> <span class="o">=</span> <span class="n">lineargs</span>

<div class="viewcode-block" id="PredictionBand.add"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a possible prediction *y*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="PredictionBand.set_shadeargs"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.set_shadeargs">[docs]</a>    <span class="k">def</span> <span class="nf">set_shadeargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set matplotlib style for shading.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadeargs</span> <span class="o">=</span> <span class="n">kwargs</span></div>

<div class="viewcode-block" id="PredictionBand.set_lineargs"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.set_lineargs">[docs]</a>    <span class="k">def</span> <span class="nf">set_lineargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set matplotlib style for line.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineargs</span> <span class="o">=</span> <span class="n">kwargs</span></div>

<div class="viewcode-block" id="PredictionBand.get_line"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.get_line">[docs]</a>    <span class="k">def</span> <span class="nf">get_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Over prediction space x, get quantile *q*. Default is median.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">q</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;quantile q must be between 0 and 1, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ys</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mstats</span><span class="o">.</span><span class="n">mquantiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="PredictionBand.shade"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.shade">[docs]</a>    <span class="k">def</span> <span class="nf">shade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.341</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot a shaded region between 0.5-q and 0.5+q. Default is 1 sigma.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">q</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;quantile distance from the median, q, must be between 0 and 0.5, not </span><span class="si">%s</span><span class="s2">. For a 99% quantile range, use q=0.48.&quot;</span> <span class="o">%</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">shadeargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadeargs</span><span class="p">)</span>
        <span class="n">shadeargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="o">**</span><span class="n">shadeargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PredictionBand.line"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.PredictionBand.line">[docs]</a>    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the median curve.&quot;&quot;&quot;</span>
        <span class="n">lineargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineargs</span><span class="p">)</span>
        <span class="n">lineargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="o">**</span><span class="n">lineargs</span><span class="p">)</span></div></div>


<span class="c1"># the following function is taken from https://github.com/joshspeagle/dynesty/blob/master/dynesty/plotting.py</span>
<span class="c1"># Copyright (c) 2017 - Present: Josh Speagle and contributors.</span>
<span class="c1"># Copyright (c) 2014 - 2017: Kyle Barbary and contributors.</span>
<span class="c1"># https://github.com/joshspeagle/dynesty/blob/master/LICENSE</span>
<div class="viewcode-block" id="runplot"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.runplot">[docs]</a><span class="k">def</span> <span class="nf">runplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nkde</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">plot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lnz_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">lnz_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truth_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">truth_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">max_x_ticks</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">max_y_ticks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">use_math_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">mark_final_live</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot live points, ln(likelihood), ln(weight), and ln(evidence) vs. ln(prior volume).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results : dynesty.results.Results instance</span>
<span class="sd">        dynesty.results.Results instance from a nested</span>
<span class="sd">        sampling run.</span>
<span class="sd">    span : iterable with shape (4,), optional</span>
<span class="sd">        A list where each element is either a length-2 tuple containing</span>
<span class="sd">        lower and upper bounds *or* a float from `(0., 1.]` giving the</span>
<span class="sd">        fraction below the maximum. If a fraction is provided,</span>
<span class="sd">        the bounds are chosen to be equal-tailed. An example would be::</span>

<span class="sd">            span = [(0., 10.), 0.001, 0.2, (5., 6.)]</span>

<span class="sd">        Default is `(0., 1.05 * max(data))` for each element.</span>
<span class="sd">    logplot : bool, optional</span>
<span class="sd">        Whether to plot the evidence on a log scale. Default is `False`.</span>
<span class="sd">    kde : bool, optional</span>
<span class="sd">        Whether to use kernel density estimation to estimate and plot</span>
<span class="sd">        the PDF of the importance weights as a function of log-volume</span>
<span class="sd">        (as opposed to the importance weights themselves). Default is</span>
<span class="sd">        `True`.</span>
<span class="sd">    nkde : int, optional</span>
<span class="sd">        The number of grid points used when plotting the kernel density</span>
<span class="sd">        estimate. Default is `1000`.</span>
<span class="sd">    color : str or iterable with shape (4,), optional</span>
<span class="sd">        A `~matplotlib`-style color (either a single color or a different</span>
<span class="sd">        value for each subplot) used when plotting the lines in each subplot.</span>
<span class="sd">        Default is `&#39;blue&#39;`.</span>
<span class="sd">    plot_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be passed to `plot`.</span>
<span class="sd">    label_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be sent to the</span>
<span class="sd">        `~matplotlib.axes.Axes.set_xlabel` and</span>
<span class="sd">        `~matplotlib.axes.Axes.set_ylabel` methods.</span>
<span class="sd">    lnz_error : bool, optional</span>
<span class="sd">        Whether to plot the 1, 2, and 3-sigma approximate error bars</span>
<span class="sd">        derived from the ln(evidence) error approximation over the course</span>
<span class="sd">        of the run. Default is True.</span>
<span class="sd">    lnz_truth : float, optional</span>
<span class="sd">        A reference value for the evidence that will be overplotted on the</span>
<span class="sd">        evidence subplot if provided.</span>
<span class="sd">    truth_color : str or iterable with shape (ndim,), optional</span>
<span class="sd">        A `~matplotlib`-style color used when plotting `lnz_truth`.</span>
<span class="sd">        Default is `&#39;red&#39;`.</span>
<span class="sd">    truth_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be used for plotting</span>
<span class="sd">        `lnz_truth`.</span>
<span class="sd">    max_x_ticks : int, optional</span>
<span class="sd">        Maximum number of ticks allowed for the x axis. Default is `8`.</span>
<span class="sd">    max_y_ticks : int, optional</span>
<span class="sd">        Maximum number of ticks allowed for the y axis. Default is `4`.</span>
<span class="sd">    use_math_text : bool, optional</span>
<span class="sd">        Whether the axis tick labels for very large/small exponents should be</span>
<span class="sd">        displayed as powers of 10 rather than using `e`. Default is `False`.</span>
<span class="sd">    mark_final_live : bool, optional</span>
<span class="sd">        Whether to indicate the final addition of recycled live points</span>
<span class="sd">        (if they were added to the resulting samples) using</span>
<span class="sd">        a dashed vertical line. Default is `True`.</span>
<span class="sd">    fig : (`~matplotlib.figure.Figure`, `~matplotlib.axes.Axes`), optional</span>
<span class="sd">        If provided, overplot the run onto the provided figure.</span>
<span class="sd">        Otherwise, by default an internal figure is generated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    runplot : (`~matplotlib.figure.Figure`, `~matplotlib.axes.Axes`)</span>
<span class="sd">        Output summary plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize values.</span>
    <span class="k">if</span> <span class="n">label_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">truth_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">truth_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1"># Set defaults.</span>
    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
    <span class="n">truth_kwargs</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">truth_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s1">&#39;solid&#39;</span><span class="p">)</span>
    <span class="n">truth_kwargs</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">truth_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Extract results.</span>
    <span class="n">niter</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;niter&#39;</span><span class="p">]</span>  <span class="c1"># number of iterations</span>
    <span class="n">logvol</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logvol&#39;</span><span class="p">]</span>  <span class="c1"># ln(prior volume)</span>
    <span class="n">logl</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logl&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;logl&#39;</span><span class="p">])</span>  <span class="c1"># ln(normalized likelihood)</span>
    <span class="n">logwt</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logwt&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logz&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># ln(importance weight)</span>
    <span class="n">logz</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logz&#39;</span><span class="p">]</span>  <span class="c1"># ln(evidence)</span>
    <span class="n">logzerr</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logzerr&#39;</span><span class="p">]</span>  <span class="c1"># error in ln(evidence)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>
    <span class="n">logzerr</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">logzerr</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">nsamps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">logwt</span><span class="p">)</span>  <span class="c1"># number of samples</span>

    <span class="c1"># Check whether the run was &quot;static&quot; or &quot;dynamic&quot;.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">nlive</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;samples_n&#39;</span><span class="p">]</span>
        <span class="n">mark_final_live</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">nlive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">niter</span><span class="p">)</span> <span class="o">*</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;nlive&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nsamps</span> <span class="o">-</span> <span class="n">niter</span> <span class="o">==</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;nlive&#39;</span><span class="p">]:</span>
            <span class="n">nlive_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;nlive&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nlive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nlive</span><span class="p">,</span> <span class="n">nlive_final</span><span class="p">)</span>

    <span class="c1"># Check if the final set of live points were added to the results.</span>
    <span class="k">if</span> <span class="n">mark_final_live</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nsamps</span> <span class="o">-</span> <span class="n">niter</span> <span class="o">==</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;nlive&#39;</span><span class="p">]:</span>
            <span class="n">live_idx</span> <span class="o">=</span> <span class="n">niter</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The number of iterations and samples differ &quot;</span>
                          <span class="s2">&quot;by an amount that isn&#39;t the number of final &quot;</span>
                          <span class="s2">&quot;live points. `mark_final_live` has been disabled.&quot;</span><span class="p">)</span>
            <span class="n">mark_final_live</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Determine plotting bounds for each subplot.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlive</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logl</span><span class="p">),</span> <span class="n">weights</span><span class="p">,</span> <span class="n">logz</span> <span class="k">if</span> <span class="n">logplot</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logz</span><span class="p">)]</span>

    <span class="n">kde</span> <span class="o">=</span> <span class="n">kde</span> <span class="ow">and</span> <span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">logvol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="n">kde</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># from scipy.ndimage import gaussian_filter as norm_kde</span>
            <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gaussian_kde</span>
            <span class="c1"># Derive kernel density estimate.</span>
            <span class="n">wt_kde</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">resample_equal</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>  <span class="c1"># KDE</span>
            <span class="n">logvol_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">logvol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logvol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nkde</span><span class="p">)</span>  <span class="c1"># resample</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">wt_kde</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="o">-</span><span class="n">logvol_new</span><span class="p">)</span>  <span class="c1"># evaluate KDE PDF</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">kde</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">span</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.05</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">no_span</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">no_span</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">span</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">span</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;More bounds provided in `span` than subplots!&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">lnz_error</span> <span class="ow">and</span> <span class="n">no_span</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logplot</span><span class="p">:</span>
            <span class="n">zspan</span> <span class="o">=</span> <span class="p">(</span><span class="n">logz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">10.3</span> <span class="o">*</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                     <span class="n">logz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.3</span> <span class="o">*</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">span</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">zspan</span>

    <span class="c1"># Setting up default plot layout.</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">logvol</span><span class="p">))</span> <span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="n">span</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provided axes do not match the required shape &quot;</span>
                             <span class="s2">&quot;for plotting samples.&quot;</span><span class="p">)</span>
        <span class="c1"># If figure is provided, keep previous bounds if they were larger.</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
        <span class="c1"># One exception: if the bounds are the plotting default `(0., 1.)`,</span>
        <span class="c1"># overwrite them.</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">if</span> <span class="n">t</span> <span class="o">!=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">xspan</span><span class="p">]</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">if</span> <span class="n">t</span> <span class="o">!=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">yspan</span><span class="p">]</span>

    <span class="c1"># Set up bounds for plotting.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">xspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">xspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">logvol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">logvol</span><span class="p">),</span> <span class="n">xspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">yspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">yspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">yspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">yspan</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

    <span class="c1"># Plotting.</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Live Points&#39;</span><span class="p">,</span> <span class="s1">&#39;Likelihood</span><span class="se">\n</span><span class="s1">(normalized)&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Importance</span><span class="se">\n</span><span class="s1">Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Evidence&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">kde</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39; PDF&#39;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

        <span class="c1"># Establish axes.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Set color(s)/colormap(s).</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">str_type</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">color</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Setup axes.</span>
        <span class="k">if</span> <span class="n">max_x_ticks</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">max_x_ticks</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">max_y_ticks</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">max_y_ticks</span><span class="p">))</span>
        <span class="c1"># Label axes.</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useMathText</span><span class="o">=</span><span class="n">use_math_text</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$-\ln X$&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>
        <span class="c1"># Plot run.</span>
        <span class="k">if</span> <span class="n">logplot</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">yspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span> <span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">kde</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">logvol_new</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">lnz_error</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logplot</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">logz</span> <span class="o">&gt;=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span>
                <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="p">(</span><span class="n">logz</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">)[</span><span class="n">mask</span><span class="p">],</span>
                                 <span class="p">(</span><span class="n">logz</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">)[</span><span class="n">mask</span><span class="p">],</span>
                                 <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logz</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">),</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logz</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">logzerr</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
        <span class="c1"># Mark addition of final live points.</span>
        <span class="k">if</span> <span class="n">mark_final_live</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">[</span><span class="n">live_idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">live_idx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="c1"># Add truth value(s).</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">lnz_truth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logplot</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lnz_truth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lnz_truth</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<div class="viewcode-block" id="traceplot"><a class="viewcode-back" href="../../ultranest.html#ultranest.plot.traceplot">[docs]</a><span class="k">def</span> <span class="nf">traceplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">],</span> <span class="n">smooth</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
              <span class="n">post_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">post_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nkde</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
              <span class="n">trace_cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">trace_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trace_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">connect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">connect_highlight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">connect_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
              <span class="n">connect_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_n_ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">use_math_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">show_titles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title_fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">title_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">truths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truth_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">truth_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot traces and marginalized posteriors for each parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results : `~dynesty.results.Results` instance</span>
<span class="sd">        A `~dynesty.results.Results` instance from a nested</span>
<span class="sd">        sampling run. **Compatible with results derived from**</span>
<span class="sd">        `nestle &lt;http://kylebarbary.com/nestle/&gt;`_.</span>
<span class="sd">    span : iterable with shape (ndim,), optional</span>
<span class="sd">        A list where each element is either a length-2 tuple containing</span>
<span class="sd">        lower and upper bounds or a float from `(0., 1.]` giving the</span>
<span class="sd">        fraction of (weighted) samples to include. If a fraction is provided,</span>
<span class="sd">        the bounds are chosen to be equal-tailed. An example would be::</span>

<span class="sd">            span = [(0., 10.), 0.95, (5., 6.)]</span>

<span class="sd">        Default is `0.999999426697` (5-sigma credible interval) for each</span>
<span class="sd">        parameter.</span>
<span class="sd">    quantiles : iterable, optional</span>
<span class="sd">        A list of fractional quantiles to overplot on the 1-D marginalized</span>
<span class="sd">        posteriors as vertical dashed lines. Default is `[0.025, 0.5, 0.975]`</span>
<span class="sd">        (the 95%/2-sigma credible interval).</span>
<span class="sd">    smooth : float or iterable with shape (ndim,), optional</span>
<span class="sd">        The standard deviation (either a single value or a different value for</span>
<span class="sd">        each subplot) for the Gaussian kernel used to smooth the 1-D</span>
<span class="sd">        marginalized posteriors, expressed as a fraction of the span.</span>
<span class="sd">        Default is `0.02` (2% smoothing). If an integer is provided instead,</span>
<span class="sd">        this will instead default to a simple (weighted) histogram with</span>
<span class="sd">        `bins=smooth`.</span>
<span class="sd">    post_color : str or iterable with shape (ndim,), optional</span>
<span class="sd">        A `~matplotlib`-style color (either a single color or a different</span>
<span class="sd">        value for each subplot) used when plotting the histograms.</span>
<span class="sd">        Default is `&#39;blue&#39;`.</span>
<span class="sd">    post_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be used for plotting the</span>
<span class="sd">        marginalized 1-D posteriors.</span>
<span class="sd">    kde : bool, optional</span>
<span class="sd">        Whether to use kernel density estimation to estimate and plot</span>
<span class="sd">        the PDF of the importance weights as a function of log-volume</span>
<span class="sd">        (as opposed to the importance weights themselves). Default is</span>
<span class="sd">        `True`.</span>
<span class="sd">    nkde : int, optional</span>
<span class="sd">        The number of grid points used when plotting the kernel density</span>
<span class="sd">        estimate. Default is `1000`.</span>
<span class="sd">    trace_cmap : str or iterable with shape (ndim,), optional</span>
<span class="sd">        A `~matplotlib`-style colormap (either a single colormap or a</span>
<span class="sd">        different colormap for each subplot) used when plotting the traces,</span>
<span class="sd">        where each point is colored according to its weight. Default is</span>
<span class="sd">        `&#39;plasma&#39;`.</span>
<span class="sd">    trace_color : str or iterable with shape (ndim,), optional</span>
<span class="sd">        A `~matplotlib`-style color (either a single color or a</span>
<span class="sd">        different color for each subplot) used when plotting the traces.</span>
<span class="sd">        This overrides the `trace_cmap` option by giving all points</span>
<span class="sd">        the same color. Default is `None` (not used).</span>
<span class="sd">    trace_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be used for plotting the traces.</span>
<span class="sd">    connect : bool, optional</span>
<span class="sd">        Whether to draw lines connecting the paths of unique particles.</span>
<span class="sd">        Default is `False`.</span>
<span class="sd">    connect_highlight : int or iterable, optional</span>
<span class="sd">        If `connect=True`, highlights the paths of a specific set of</span>
<span class="sd">        particles. If an integer is passed, :data:`connect_highlight`</span>
<span class="sd">        random particle paths will be highlighted. If an iterable is passed,</span>
<span class="sd">        then the particle paths corresponding to the provided indices</span>
<span class="sd">        will be highlighted.</span>
<span class="sd">    connect_color : str, optional</span>
<span class="sd">        The color of the highlighted particle paths. Default is `&#39;red&#39;`.</span>
<span class="sd">    connect_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments used for plotting particle paths.</span>
<span class="sd">    max_n_ticks : int, optional</span>
<span class="sd">        Maximum number of ticks allowed. Default is `5`.</span>
<span class="sd">    use_math_text : bool, optional</span>
<span class="sd">        Whether the axis tick labels for very large/small exponents should be</span>
<span class="sd">        displayed as powers of 10 rather than using `e`. Default is `False`.</span>
<span class="sd">    labels : iterable with shape (ndim,), optional</span>
<span class="sd">        A list of names for each parameter. If not provided, the default name</span>
<span class="sd">        used when plotting will follow :math:`x_i` style.</span>
<span class="sd">    label_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be sent to the</span>
<span class="sd">        `~matplotlib.axes.Axes.set_xlabel` and</span>
<span class="sd">        `~matplotlib.axes.Axes.set_ylabel` methods.</span>
<span class="sd">    show_titles : bool, optional</span>
<span class="sd">        Whether to display a title above each 1-D marginalized posterior</span>
<span class="sd">        showing the 0.5 quantile along with the upper/lower bounds associated</span>
<span class="sd">        with the 0.025 and 0.975 (95%/2-sigma credible interval) quantiles.</span>
<span class="sd">        Default is `True`.</span>
<span class="sd">    title_fmt : str, optional</span>
<span class="sd">        The format string for the quantiles provided in the title. Default is</span>
<span class="sd">        `&#39;.2f&#39;`.</span>
<span class="sd">    title_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be sent to the</span>
<span class="sd">        `~matplotlib.axes.Axes.set_title` command.</span>
<span class="sd">    truths : iterable with shape (ndim,), optional</span>
<span class="sd">        A list of reference values that will be overplotted on the traces and</span>
<span class="sd">        marginalized 1-D posteriors as solid horizontal/vertical lines.</span>
<span class="sd">        Individual values can be exempt using `None`. Default is `None`.</span>
<span class="sd">    truth_color : str or iterable with shape (ndim,), optional</span>
<span class="sd">        A `~matplotlib`-style color (either a single color or a different</span>
<span class="sd">        value for each subplot) used when plotting `truths`.</span>
<span class="sd">        Default is `&#39;red&#39;`.</span>
<span class="sd">    truth_kwargs : dict, optional</span>
<span class="sd">        Extra keyword arguments that will be used for plotting the vertical</span>
<span class="sd">        and horizontal lines with `truths`.</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        Whether to print the values of the computed quantiles associated with</span>
<span class="sd">        each parameter. Default is `False`.</span>
<span class="sd">    fig : (`~matplotlib.figure.Figure`, `~matplotlib.axes.Axes`), optional</span>
<span class="sd">        If provided, overplot the traces and marginalized 1-D posteriors</span>
<span class="sd">        onto the provided figure. Otherwise, by default an</span>
<span class="sd">        internal figure is generated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    traceplot : (`~matplotlib.figure.Figure`, `~matplotlib.axes.Axes`)</span>
<span class="sd">        Output trace plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize values.</span>
    <span class="k">if</span> <span class="n">title_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">label_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">trace_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">trace_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">connect_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">connect_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">post_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">post_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">truth_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">truth_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1"># Set defaults.</span>
    <span class="n">connect_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connect_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
    <span class="n">post_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">post_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="n">trace_kwargs</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trace_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">truth_kwargs</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">truth_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s1">&#39;solid&#39;</span><span class="p">)</span>
    <span class="n">truth_kwargs</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">truth_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Extract weighted samples.</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;samples&#39;</span><span class="p">]</span>
    <span class="n">logvol</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;logvol&#39;</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>

    <span class="n">wts</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="n">kde</span> <span class="o">=</span> <span class="n">kde</span> <span class="ow">and</span> <span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">logvol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="n">kde</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span> <span class="k">as</span> <span class="n">norm_kde</span>
            <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gaussian_kde</span>
            <span class="c1"># Derive kernel density estimate.</span>
            <span class="n">wt_kde</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">resample_equal</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>  <span class="c1"># KDE</span>
            <span class="n">logvol_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">logvol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logvol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nkde</span><span class="p">)</span>  <span class="c1"># resample</span>
            <span class="n">wt_grid</span> <span class="o">=</span> <span class="n">wt_kde</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="o">-</span><span class="n">logvol_grid</span><span class="p">)</span>  <span class="c1"># evaluate KDE PDF</span>
            <span class="n">wts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="o">-</span><span class="n">logvol_grid</span><span class="p">,</span> <span class="n">wt_grid</span><span class="p">)</span>  <span class="c1"># interpolate</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">kde</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Deal with 1D results. A number of extra catches are also here</span>
    <span class="c1"># in case users are trying to plot other results besides the `Results`</span>
    <span class="c1"># instance generated by `dynesty`.</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Samples must be 1- or 2-D.&quot;</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">T</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;There are more dimensions than samples!&quot;</span>
    <span class="n">ndim</span><span class="p">,</span> <span class="n">nsamps</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Check weights.</span>
    <span class="k">if</span> <span class="n">weights</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Weights must be 1-D.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nsamps</span> <span class="o">!=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of weights and samples disagree!&quot;</span><span class="p">)</span>

    <span class="c1"># Check ln(volume).</span>
    <span class="k">if</span> <span class="n">logvol</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ln(volume)&#39;s must be 1-D.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nsamps</span> <span class="o">!=</span> <span class="n">logvol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of ln(volume)&#39;s and samples disagree!&quot;</span><span class="p">)</span>

    <span class="c1"># Check sample IDs.</span>
    <span class="k">if</span> <span class="n">connect</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">samples_id</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;samples_id&#39;</span><span class="p">]</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">samples_id</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample IDs are not defined!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">connect_highlight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">connect_highlight</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">connect_highlight</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Determine plotting bounds for marginalized 1-D posteriors.</span>
    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">span</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.999999426697</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)]</span>
    <span class="n">span</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">span</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ndim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dimension mismatch between samples and span.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_quantile</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Setting up labels.</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$x_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)]</span>

    <span class="c1"># Setting up smoothing.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="n">int_type</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="n">float_type</span><span class="p">)):</span>
        <span class="n">smooth</span> <span class="o">=</span> <span class="p">[</span><span class="n">smooth</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)]</span>

    <span class="c1"># Setting up default plot layout.</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provided axes do not match the required shape &quot;</span>
                             <span class="s2">&quot;for plotting samples.&quot;</span><span class="p">)</span>

    <span class="c1"># Plotting.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>

        <span class="c1"># Plot trace.</span>

        <span class="c1"># Establish axes.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">samples</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Set color(s)/colormap(s).</span>
        <span class="k">if</span> <span class="n">trace_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace_color</span><span class="p">,</span> <span class="n">str_type</span><span class="p">):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">trace_color</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">trace_color</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">wts</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace_cmap</span><span class="p">,</span> <span class="n">str_type</span><span class="p">):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">trace_cmap</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">trace_cmap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Setup axes.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">logvol</span><span class="p">)])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">max_n_ticks</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">max_n_ticks</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">max_n_ticks</span><span class="p">))</span>
        <span class="c1"># Label axes.</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useMathText</span><span class="o">=</span><span class="n">use_math_text</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$-\ln X$&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>
        <span class="c1"># Generate scatter plot.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">trace_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">connect</span><span class="p">:</span>
            <span class="c1"># Add lines highlighting specific particle paths.</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples_id</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">logvol</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">connect_color</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">connect_kwargs</span><span class="p">)</span>
        <span class="c1"># Add truth value(s).</span>
        <span class="k">if</span> <span class="n">truths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>

        <span class="c1"># Plot marginalized 1-D posterior.</span>

        <span class="c1"># Establish axes.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">samples</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Set color(s).</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">post_color</span><span class="p">,</span> <span class="n">str_type</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">post_color</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">post_color</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Setup axes</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">max_n_ticks</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">max_n_ticks</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="c1"># Label axes.</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useMathText</span><span class="o">=</span><span class="n">use_math_text</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>
        <span class="c1"># Generate distribution.</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">int_type</span><span class="p">):</span>
            <span class="c1"># If `s` is an integer, plot a weighted histogram with</span>
            <span class="c1"># `s` bins within the provided bounds.</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                              <span class="nb">range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="o">**</span><span class="n">post_kwargs</span><span class="p">)</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If `s` is a float, oversample the data relative to the</span>
            <span class="c1"># smoothing filter by a factor of 10, then use a Gaussian</span>
            <span class="c1"># filter to smooth the results.</span>
            <span class="k">if</span> <span class="n">kde</span><span class="p">:</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mf">10.</span> <span class="o">/</span> <span class="n">s</span><span class="p">))</span>
                <span class="n">n</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
                                    <span class="nb">range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">norm_kde</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="n">n</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">post_kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="mi">40</span>
                <span class="n">n</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
                                    <span class="nb">range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">span</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="n">n</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">post_kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">])</span>
        <span class="c1"># Plot quantiles.</span>
        <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">qs</span> <span class="o">=</span> <span class="n">_quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">quantiles</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantiles:&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">blob</span> <span class="k">for</span> <span class="n">blob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">qs</span><span class="p">)])</span>
        <span class="c1"># Add truth value(s).</span>
        <span class="k">if</span> <span class="n">truths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">truths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">truth_color</span><span class="p">,</span> <span class="o">**</span><span class="n">truth_kwargs</span><span class="p">)</span>
        <span class="c1"># Set titles.</span>
        <span class="k">if</span> <span class="n">show_titles</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">title_fmt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ql</span><span class="p">,</span> <span class="n">qm</span><span class="p">,</span> <span class="n">qh</span> <span class="o">=</span> <span class="n">_quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
                <span class="n">q_minus</span><span class="p">,</span> <span class="n">q_plus</span> <span class="o">=</span> <span class="n">qm</span> <span class="o">-</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qh</span> <span class="o">-</span> <span class="n">qm</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;{{0:</span><span class="si">{0}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title_fmt</span><span class="p">)</span><span class="o">.</span><span class="n">format</span>
                <span class="n">title</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;${{</span><span class="si">{0}</span><span class="s2">}}_{{-</span><span class="si">{1}</span><span class="s2">}}^{{+</span><span class="si">{2}</span><span class="s2">}}$&quot;</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">(</span><span class="n">qm</span><span class="p">),</span> <span class="n">fmt</span><span class="p">(</span><span class="n">q_minus</span><span class="p">),</span> <span class="n">fmt</span><span class="p">(</span><span class="n">q_plus</span><span class="p">))</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> = </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">title</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">title_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2014-2020, Johannes Buchner

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>